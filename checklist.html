<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Prevenção - Saúde do Homem</title>
</head>
<body>

    <header>
        <h1><p class="site-title"><a href="home.html">Guia da Saúde do Homem</a></p></h1>

        <nav aria-label="Navegação principal">
            <ul>
                <li><a href="home.html">Início</a></li>
                <li><a href="prevencao.html">Prevenção</a></li>
                <li><a href="saude-mental.html">Saúde Mental</a></li>
                <li><a href="checklist.html">Checklist e Desafios</a></li>
                <li><a href="ranking.html" aria-current="page">Ranking</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="container-prevencao">
            <h1>Checklist e Desafios da Saúde Masculina</h1>

            <div class="intro-section">
                <img src="https://via.placeholder.com/100" alt="Homem saudável" class="section-icon">
                <p>Nesta página, você encontrará informações essenciais sobre exames preventivos e desafios comuns à saúde do homem, ajudando a promover um estilo de vida mais saudável e consciente.</p>
            </div>

            <section class="card-topico" id="exames">
                <div class="card-header">
                    <h2>Exames Essenciais</h2>
                    <img src="https://via.placeholder.com/50" alt="Ícone de exame" class="card-icon">
                </div>
                <p>Mantenha sua saúde em dia com uma rotina de exames preventivos...</p>

                <ul class="checklist-exames">
                    <li>
                        <input type="checkbox" id="exame-1">
                        <label for="exame-1"><strong>Check-up Geral:</strong> Avaliação completa com exames de sangue e urina.</label>
                        <p class="item-description">Recomendado anualmente para monitorar glicemia, colesterol, função renal e hepática.</p>
                    </li>
                    <li>
                        <input type="checkbox" id="exame-2">
                        <label for="exame-2"><strong>Antígeno Prostático Específico (PSA):</strong> Para detecção precoce de problemas na próstata.</label>
                        <p class="item-description">Geralmente a partir dos 45-50 anos, dependendo do histórico familiar.</p>
                    </li>
                    <li>
                        <input type="checkbox" id="exame-3">
                        <label for="exame-3"><strong>Pressão Arterial:</strong> Monitoramento regular para prevenir hipertensão.</label>
                        <p class="item-description">Verificar em consultas de rotina ou em casa com aparelhos validados.</p>
                    </li>
                    <li>
                        <input type="checkbox" id="exame-4">
                        <label for="exame-4"><strong>Colesterol e Triglicerídeos:</strong> Avaliação do perfil lipídico.</label>
                        <p class="item-description">Importante para prevenir doenças cardiovasculares.</p>
                    </li>
                    <li>
                        <input type="checkbox" id="exame-5">
                        <label for="exame-5"><strong>Glicemia:</strong> Medição do açúcar no sangue para controle de diabetes.</label>
                        <p class="item-description">Fundamental para diagnóstico e controle do diabetes.</p>
                    </li>
                </ul>

                <div class="progresso-container">
                    <div id="barraExames"></div>
                </div>
                <p id="textoExames">0% dos exames concluídos</p>

                <a href="#" class="btn btn-primary">Saiba Mais sobre Exames</a>
            </section>

            <section class="card-topico" id="meus-desafios">
                <div class="card-header">
                    <h2>Meu Checklist Pessoal</h2>
                </div>
                <p>Use este espaço para marcar suas conquistas e construir hábitos saudáveis.</p>

                <div class="desafio-grupo">
                    <h3>Desafios Diários</h3>
                    <ul class="checklist-interativo" id="lista-diario">
                        <li>
                            <input type="checkbox" id="diario-1" name="diario-1">
                            <label for="diario-1">Beber 2 litros de água</label>
                        </li>
                        <li>
                            <input type="checkbox" id="diario-2" name="diario-2">
                            <label for="diario-2">Praticar 30 min de atividade física</label>
                        </li>
                        <li>
                            <input type="checkbox" id="diario-3" name="diario-3">
                            <label for="diario-3">Dormir 7-8 horas</label>
                        </li>
                        <li>
                            <input type="checkbox" id="diario-4" name="diario-4">
                            <label for="diario-4">Comer 3 porções de frutas/vegetais</label>
                        </li>
                    </ul>
                </div>

                <div class="desafio-grupo">
                    <h3>Desafios Semanais</h3>
                    <ul class="checklist-interativo" id="lista-semanal">
                        <li>
                            <input type="checkbox" id="semanal-1" name="semanal-1">
                            <label for="semanal-1">Praticar 3x exercícios (ex: musculação, corrida)</label>
                        </li>
                        <li>
                            <input type="checkbox" id="semanal-2" name="semanal-2">
                            <label for="semanal-2">Tirar um tempo para um hobby(Livro, tocar um instrumento)</label>
                        </li>
                        <li>
                            <input type="checkbox" id="semanal-3" name="semanal-3">
                            <label for="semanal-3">Planejar as refeições da semana</label>
                        </li>
                    </ul>
                </div>

                <div class="desafio-grupo">
                    <h3>Desafios Mensais</h3>
                    <ul class="checklist-interativo" id="lista-mensal">
                        <li>
                            <input type="checkbox" id="mensal-1" name="mensal-1">
                            <label for="mensal-1">Revisar metas pessoais e profissionais</label>
                        </li>
                        <li>
                            <input type="checkbox" id="mensal-2" name="mensal-2">
                            <label for="mensal-2">Verificar agendamento de check-up</label>
                        </li>
                        <li>
                            <input type="checkbox" id="mensal-3" name="mensal-3">
                            <label for="mensal-3">Fazer uma "limpeza" digital (arquivos, e-mails)</label>
                        </li>
                    </ul>
                </div>

                <div class="desafio-grupo" id="desafio-custom">
                    <h3>Adicionar Meu Próprio Desafio</h3>
                    <form id="desafio-form">
                        <label for="desafio-nome">Nome do Desafio:</label>
                        <input type="text" id="desafio-nome" placeholder="Ex: Ler 10 páginas de um livro" required>
                        
                        <label for="desafio-tipo">Tipo:</label>
                        <select id="desafio-tipo">
                            <option value="diario">Diário</option>
                            <option value="semanal">Semanal</option>
                            <option value="mensal">Mensal</option>
                        </select>
                        
                        <div id="desafio-success" class="success-text"></div>
                        <button type="submit" class="btn btn-secondary">Adicionar Desafio</button>
                    </form>
                </div>
            </section>
            
            <section class="card-topico" id="recursos"></section>

        </section> </main>
        <div class="accessibility-fixed-btn">
        <div class="switch">
            <label 
                for="switch-button"
                class="switch__label">
                Modo Noturno
            </label>
            <button
                id="switch-button" 
                class="switch__button"
                role="switch"
                aria-checked="false">
                <span class="button__text--on">on</span>
                <span class="button__text--off">off</span>
            </button>
        </div>
    </div>
    
    <script src="accessibility.js" defer></script>
    <script>
        // --- PARTE 1: LÓGICA DA BARRA DE PROGRESSO ---
        
        let checkboxes = document.querySelectorAll('.checklist-interativo input[type="checkbox"]');
        const barra = document.createElement('div');
        const texto = document.createElement('p');
        const progressoContainer = document.createElement('div');
        progressoContainer.classList.add('progresso-container');
        barra.id = 'barraProgresso';
        texto.id = 'textoProgresso';
        texto.textContent = '0% concluído';
        progressoContainer.appendChild(barra);
        document.querySelector('#meus-desafios').appendChild(progressoContainer);
        document.querySelector('#meus-desafios').appendChild(texto);

        function atualizarProgresso() {
            checkboxes = document.querySelectorAll('.checklist-interativo input[type="checkbox"]');
            const total = checkboxes.length;
            const marcados = Array.from(checkboxes).filter(c => c.checked).length;
            const porcentagem = (total > 0) ? Math.round((marcados / total) * 100) : 0;
            barra.style.width = porcentagem + '%';
            texto.textContent = porcentagem + '% concluído';
            checkboxes.forEach((c) => {
                localStorage.setItem('desafio-' + c.id, c.checked);
            });
        }

        function restaurarEstado() {
            checkboxes.forEach((c) => {
                const salvo = localStorage.getItem('desafio-' + c.id);
                if (salvo === 'true') c.checked = true;
                c.addEventListener('change', atualizarProgresso);
            });
        }

        // --- PARTE 2: LÓGICA DE ADICIONAR NOVOS DESAFIOS ---

        const desafioForm = document.getElementById('desafio-form');
        const desafioNomeInput = document.getElementById('desafio-nome');
        const desafioTipoSelect = document.getElementById('desafio-tipo');
        const desafioSuccess = document.getElementById('desafio-success');
        const meusDesafiosCard = document.querySelector('#meus-desafios'); // Seleciona o card pai

        // ATUALIZADO: Adiciona o botão 'X' ao HTML
        function adicionarDesafioNaTela(nome, tipo, idDesafio) {
            const listaCorreta = document.getElementById(`lista-${tipo}`);
            const novoLi = document.createElement('li');
            novoLi.innerHTML = `
                <input type="checkbox" id="${idDesafio}" name="${idDesafio}">
                <label for="${idDesafio}">${nome} (Adicionado)</label>
                <button class="desafio-apagar" title="Apagar desafio">X</button>
            `;
            listaCorreta.appendChild(novoLi);
            const novoCheckbox = document.getElementById(idDesafio);
            novoCheckbox.addEventListener('change', atualizarProgresso);
        }

        function carregarDesafios() {
            const desafiosSalvos = JSON.parse(localStorage.getItem('meusDesafios')) || [];
            desafiosSalvos.forEach(desafio => {
                adicionarDesafioNaTela(desafio.nome, desafio.tipo, desafio.id);
            });
        }

        function salvarDesafio(nome, tipo, idDesafio) {
            const desafiosSalvos = JSON.parse(localStorage.getItem('meusDesafios')) || [];
            desafiosSalvos.push({ nome: nome, tipo: tipo, id: idDesafio });
            localStorage.setItem('meusDesafios', JSON.stringify(desafiosSalvos));
        }
        
        // =============================================
        // ===         NOVA FUNÇÃO DE APAGAR         ===
        // =============================================
        function apagarDesafio(idDesafio) {
            // 1. Remove do localStorage (a lista de desafios)
            let desafiosSalvos = JSON.parse(localStorage.getItem('meusDesafios')) || [];
            desafiosSalvos = desafiosSalvos.filter(d => d.id !== idDesafio);
            localStorage.setItem('meusDesafios', JSON.stringify(desafiosSalvos));

            // 2. Remove o estado (marcado/desmarcado) do localStorage
            localStorage.removeItem('desafio-' + idDesafio);

            // 3. Remove da tela (do DOM)
            const checkbox = document.getElementById(idDesafio);
            if (checkbox) {
                checkbox.closest('li').remove();
            }

            // 4. Atualiza a barra de progresso
            atualizarProgresso();
        }
        // =============================================

        desafioForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const nome = desafioNomeInput.value;
            const tipo = desafioTipoSelect.value;
            const idDesafio = `custom-${tipo}-${Date.now()}`;
            adicionarDesafioNaTela(nome, tipo, idDesafio);
            salvarDesafio(nome, tipo, idDesafio);
            atualizarProgresso();
            desafioSuccess.textContent = '✅ Desafio adicionado com sucesso!';
            desafioSuccess.style.display = 'block';
            desafioForm.reset();
            setTimeout(() => {
                desafioSuccess.style.display = 'none';
            }, 4000);
        });

        // Usa "Event Delegation" para ouvir cliques em todo o card
        meusDesafiosCard.addEventListener('click', (event) => {
            // Verifica se o que foi clicado foi um botão com a classe 'desafio-apagar'
            if (event.target.classList.contains('desafio-apagar')) {
                
                // Encontra o 'li' pai e depois o checkbox para pegar o ID
                const checkbox = event.target.closest('li').querySelector('input[type="checkbox"]');
                const idDesafio = checkbox.id;
                
                // Pede confirmação
                if (confirm('Tem a certeza que quer apagar este desafio?')) {
                    apagarDesafio(idDesafio);
                }
            }
        });
        // =============================================
        
        // CARREGA TUDO
        carregarDesafios();
        restaurarEstado();
        atualizarProgresso();
    </script>

</body>
</html>